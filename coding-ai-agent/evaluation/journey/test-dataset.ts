/**
 * Test dataset for Journey Evaluation
 * Multi-turn conversations simulating real user interactions
 */

export interface ConversationTurn {
  role: 'user' | 'assistant';
  content: string;
}

export interface JourneyTestCase {
  id: string;
  name: string;
  description: string;
  conversation: ConversationTurn[];
  expectedOutcomes: {
    // What should the conversation achieve?
    goals: string[];
    // Key points that should be covered
    keyPoints: string[];
  };
  difficulty: 'easy' | 'medium' | 'hard';
}

/**
 * 10+ complex multi-turn conversation scenarios
 * Testing end-to-end user journeys with the coding assistant
 */
export const journeyTestDataset: JourneyTestCase[] = [
  // ===== EASY (1-3) - Simple multi-turn queries =====
  {
    id: 'journey_001',
    name: 'Basic Code Lookup',
    description: 'User asks about a specific method and follows up with usage question',
    conversation: [
      {
        role: 'user',
        content: 'How do I calculate a percentage of a number?',
      },
      {
        role: 'assistant',
        content: '', // Will be generated by AI
      },
      {
        role: 'user',
        content: 'Can you show me an example of using that method?',
      },
      {
        role: 'assistant',
        content: '', // Will be generated by AI
      },
    ],
    expectedOutcomes: {
      goals: [
        'Identify the PercentageOf method',
        'Provide a practical usage example',
      ],
      keyPoints: [
        'PercentageOf method',
        'Parameters explanation',
        'Example with numbers',
      ],
    },
    difficulty: 'easy',
  },
  {
    id: 'journey_002',
    name: 'Simple Clarification Flow',
    description: 'User asks a vague question and clarifies',
    conversation: [
      {
        role: 'user',
        content: 'How do I work with discounts?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'I mean calculating the final price after applying a discount',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Handle vague initial query',
        'Respond appropriately after clarification',
      ],
      keyPoints: [
        'CalculateDiscountedPrice method',
        'Price calculation explanation',
      ],
    },
    difficulty: 'easy',
  },
  {
    id: 'journey_003',
    name: 'Basic Math Operations',
    description: 'User explores basic arithmetic operations',
    conversation: [
      {
        role: 'user',
        content: 'What basic math operations are available?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'How does the divide method handle division by zero?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'List basic arithmetic operations',
        'Explain error handling for division',
      ],
      keyPoints: [
        'BasicArithmetic class',
        'DivideByZeroException',
        'Error handling',
      ],
    },
    difficulty: 'easy',
  },

  // ===== MEDIUM (4-7) - More complex interactions =====
  {
    id: 'journey_004',
    name: 'Complex Calculation Workflow',
    description: 'User needs to chain multiple operations',
    conversation: [
      {
        role: 'user',
        content: 'I need to calculate a final price with both discount and tax',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Should I apply the discount first or the tax first?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Can you show me the code for that?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Explain operation order (discount then tax)',
        'Show method chaining',
        'Provide working code example',
      ],
      keyPoints: [
        'CalculateDiscountedPrice',
        'CalculatePriceWithTax',
        'Correct order of operations',
        'Code example',
      ],
    },
    difficulty: 'medium',
  },
  {
    id: 'journey_005',
    name: 'Comparison and Decision Making',
    description: 'User compares different approaches',
    conversation: [
      {
        role: 'user',
        content: 'What are the different ways to work with percentage changes?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Which one should I use to calculate price increase over time?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'How is that different from just using the increase method?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'List percentage change methods',
        'Recommend appropriate method',
        'Explain differences clearly',
      ],
      keyPoints: [
        'PercentageIncrease vs ApplyPercentageIncrease',
        'Use case differences',
        'Comparison explanation',
      ],
    },
    difficulty: 'medium',
  },
  {
    id: 'journey_006',
    name: 'Error Recovery',
    description: 'User encounters issue and needs help debugging',
    conversation: [
      {
        role: 'user',
        content: 'I tried using the percentage method but I\'m getting weird results',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'I passed 25 and 100, expecting 25% of 100 which is 25',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Oh, so I need to use a different method?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Identify the issue',
        'Explain correct usage',
        'Recommend right method',
      ],
      keyPoints: [
        'PercentageOf method',
        'Parameter order explanation',
        'Correct usage example',
      ],
    },
    difficulty: 'medium',
  },
  {
    id: 'journey_007',
    name: 'Feature Discovery',
    description: 'User explores what\'s available in a domain',
    conversation: [
      {
        role: 'user',
        content: 'What geometry calculations can I do?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'How do I calculate the area of a circle?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'What about the perimeter?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Provide geometry overview',
        'Explain circle area calculation',
        'Explain circle perimeter/circumference',
      ],
      keyPoints: [
        'GeometryShapes class',
        'Circle area method',
        'Circle circumference method',
      ],
    },
    difficulty: 'medium',
  },

  // ===== HARD (8-12) - Complex, multi-step scenarios =====
  {
    id: 'journey_008',
    name: 'Complex Problem Solving',
    description: 'User needs help designing a complete solution',
    conversation: [
      {
        role: 'user',
        content: 'I need to build a shopping cart price calculator',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'It should handle multiple items with different discount rates',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'And then apply a single tax rate to the total',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Can you show me a complete example with 3 items?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Understand requirements',
        'Design solution architecture',
        'Provide complete working example',
      ],
      keyPoints: [
        'CalculateDiscountedPrice for items',
        'Summing multiple items',
        'CalculatePriceWithTax on total',
        'Complete code example',
      ],
    },
    difficulty: 'hard',
  },
  {
    id: 'journey_009',
    name: 'Deep Technical Understanding',
    description: 'User wants to understand implementation details',
    conversation: [
      {
        role: 'user',
        content: 'How does the percentage calculation handle floating point precision?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'So what happens with something like 1/3 as a percentage?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Are there any methods to round or format these results?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Can you show me how to format percentage results properly?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Explain floating point behavior',
        'Discuss precision issues',
        'Provide formatting solutions',
      ],
      keyPoints: [
        'Double precision',
        'Rounding considerations',
        'FormatAsPercentage method',
        'Best practices',
      ],
    },
    difficulty: 'hard',
  },
  {
    id: 'journey_010',
    name: 'Integration Scenario',
    description: 'User integrating multiple features',
    conversation: [
      {
        role: 'user',
        content: 'I need to analyze price trends over multiple time periods',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'How can I calculate percentage change between each period?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'And also calculate the average change across all periods?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Can you help me combine percentage and statistics methods?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Identify relevant methods from multiple classes',
        'Design integration approach',
        'Provide complete solution',
      ],
      keyPoints: [
        'PercentageIncrease/Decrease',
        'Statistical methods (Mean)',
        'Array/list processing',
        'Complete example',
      ],
    },
    difficulty: 'hard',
  },
  {
    id: 'journey_011',
    name: 'Edge Case Exploration',
    description: 'User testing boundaries and error cases',
    conversation: [
      {
        role: 'user',
        content: 'What happens with negative percentages in calculations?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'And what about percentages over 100%?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Are there any validation methods to check if inputs are valid?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Should I add my own validation before calling these methods?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Explain edge case behavior',
        'Discuss validation strategies',
        'Provide best practice recommendations',
      ],
      keyPoints: [
        'Negative percentage handling',
        'Large percentage values',
        'Input validation recommendations',
        'Error handling best practices',
      ],
    },
    difficulty: 'hard',
  },
  {
    id: 'journey_012',
    name: 'Performance and Optimization',
    description: 'User concerned about performance with many calculations',
    conversation: [
      {
        role: 'user',
        content: 'I need to calculate discounts for thousands of items. Will this be efficient?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'Are these methods optimized for batch operations?',
      },
      {
        role: 'assistant',
        content: '',
      },
      {
        role: 'user',
        content: 'What would be the best approach to process a large list?',
      },
      {
        role: 'assistant',
        content: '',
      },
    ],
    expectedOutcomes: {
      goals: [
        'Address performance concerns',
        'Suggest optimization strategies',
        'Provide efficient implementation',
      ],
      keyPoints: [
        'Method efficiency',
        'Batch processing approach',
        'Code example for large datasets',
      ],
    },
    difficulty: 'hard',
  },
];

// Helper functions
export function getJourneyTestsByDifficulty(difficulty: 'easy' | 'medium' | 'hard'): JourneyTestCase[] {
  return journeyTestDataset.filter(t => t.difficulty === difficulty);
}

export function getJourneyTestById(id: string): JourneyTestCase | undefined {
  return journeyTestDataset.find(t => t.id === id);
}

export function getJourneyTestCount(): number {
  return journeyTestDataset.length;
}
